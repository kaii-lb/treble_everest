From 3473247fa54ae106fdb50efd9715ab36d7642bf8 Mon Sep 17 00:00:00 2001
From: "Christopher A. Williamson" <home@chrisaw.com>
Date: Wed, 17 Jan 2024 15:36:41 +0000
Subject: [PATCH] Add support for Voltage unsupported_commands prop

---
 ...or-Voltage-unsupported_commands-prop.patch | 26 +++++++++++++++++++
 vndk.rc                                       |  2 +-
 2 files changed, 27 insertions(+), 1 deletion(-)
 create mode 100644 0001-Add-support-for-Voltage-unsupported_commands-prop.patch

diff --git a/0001-Add-support-for-Voltage-unsupported_commands-prop.patch b/0001-Add-support-for-Voltage-unsupported_commands-prop.patch
new file mode 100644
index 0000000..37f3ad2
--- /dev/null
+++ b/0001-Add-support-for-Voltage-unsupported_commands-prop.patch
@@ -0,0 +1,26 @@
+From 1a6e871498ad83617fda748d6ef376b254e6e2da Mon Sep 17 00:00:00 2001
+From: "Christopher A. Williamson" <home@chrisaw.com>
+Date: Wed, 17 Jan 2024 11:52:25 +0000
+Subject: [PATCH] Add support for Voltage unsupported_commands prop
+
+---
+ vndk.rc | 3 +++
+ 1 file changed, 3 insertions(+)
+
+diff --git a/vndk.rc b/vndk.rc
+index 3029abf..96966aa 100644
+--- a/vndk.rc
++++ b/vndk.rc
+@@ -97,6 +97,9 @@ on property:persist.sys.phh.force_display_5g=1
+ on property:persist.sys.phh.ims.floss=true
+    exec u:r:phhsu_daemon:s0 root -- /system/bin/resetprop_phh ro.telephony.iwlan_operation_mode AP-assisted
+ 
++on property:persist.sys.bt.unsupported_commands=*
++   setprop bluetooth.hci.disabled_commands ${persist.sys.bt.unsupported_commands}
++
+ # Set watchdog timer to 30 seconds and pet it every 10 seconds to get a 20 second margin
+ service watchdogd-gsi /system/bin/watchdogd 10 20
+     class core
+-- 
+2.42.0
+
diff --git a/vndk.rc b/vndk.rc
index 96966aa..9bd97c1 100644
--- a/vndk.rc
+++ b/vndk.rc
@@ -98,7 +98,7 @@ on property:persist.sys.phh.ims.floss=true
    exec u:r:phhsu_daemon:s0 root -- /system/bin/resetprop_phh ro.telephony.iwlan_operation_mode AP-assisted
 
 on property:persist.sys.bt.unsupported_commands=*
-   setprop bluetooth.hci.disabled_commands ${persist.sys.bt.unsupported_commands}
+   exec u:r:phhsu_daemon:s0 root -- /system/bin/setprop bluetooth.hci.disabled_commands ${persist.sys.bt.unsupported_commands}
 
 # Set watchdog timer to 30 seconds and pet it every 10 seconds to get a 20 second margin
 service watchdogd-gsi /system/bin/watchdogd 10 20
-- 
2.42.0

